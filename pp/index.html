
<!DOCTYPE html>
<html lang=en>

<head>
    <title>Flash Loader | Ruffle</title>
    <meta name="robots" content="noindex,nofollow">
    <style>
        html,
        body {
            overflow: hidden;
            background: indigo;
            margin: 0;
            text-align: center;
            height: 100vh;
        }

    </style>
</head>

<body>

    <div id=container></div>

    <script>
        var passedVars = (window.location.search.substring(1));
        var gameArray = passedVars.split("-");
        var dirName = gameArray[0];
        var gameName = gameArray[1];
        var flashX = gameArray[2];
        var flashY = gameArray[3];
        var gameRatio = (flashX / flashY).toFixed(4);

        if (gameName == "!") {
            gameName = dirName;
        }

        window.RufflePlayer = window.RufflePlayer || {};

        //config options: https://github.com/ruffle-rs/ruffle/wiki/Using-Ruffle#configuration-options

        window.RufflePlayer.config = {
            "publicPath": undefined,
            "polyfills": true,
            "autoplay": "auto",
            "unmuteOverlay": "visible",
            "backgroundColor": null,
            "wmode": "window",
            "letterbox": "fullscreen",
            "warnOnUnsupportedContent": false,
            "contextMenu": "off",
            "showSwfDownload": false,
            "upgradeToHttps": window.location.protocol === "https:",
            "maxExecutionDuration": 15,
            "logLevel": "error",
            "base": null,
            "menu": false,
            "salign": "",
            "scale": "showAll",
            "quality": "high",
            "preloader": true,
            "openUrlMode": "deny", //stops potentially dangerous links
            "allowScriptAccess": false,
            "allowNetworking": "none",
        };

        if (dirName == "scaryscavengerhunt") {
            window.RufflePlayer.config.base = "/z/games/scaryscavengerhunt/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        if (dirName == "scaryscavengerhunt2") {
            window.RufflePlayer.config.base = "/z/games/scaryscavengerhunt2/"
            console.log("base:" + window.RufflePlayer.config.base);
        }

        if (dirName.indexOf("powerpamplona") > -1) {
            window.RufflePlayer.config.base = "/z/games/powerpamplona/"
            console.log("base:" + window.RufflePlayer.config.base);
        }

        if (dirName.indexOf("extremepamplona") > -1) {
            window.RufflePlayer.config.base = "/z/games/extremepamplona/"
            console.log("base:" + window.RufflePlayer.config.base);
        }

        if (dirName.indexOf("chasm") > -1) {
            window.RufflePlayer.config.base = "/z/games/chasm/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("zuma") > -1) {
            window.RufflePlayer.config.base = "/z/games/zuma/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("hollyhobbie") > -1) {
            window.RufflePlayer.config.base = "/z/games/hollyhobbiedollhouse/"
            console.log("base:" + window.RufflePlayer.config.base);
        }

        if (dirName.indexOf("snowdriftland") > -1) {
            window.RufflePlayer.config.base = "/z/games/missioninsnowdriftland/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("hallofthewild") > -1) {
            window.RufflePlayer.config.base = "/z/games/hallofthewild/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("hallofthewild2") > -1) {
            window.RufflePlayer.config.base = "/z/games/hallofthewild2/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("heist") > -1) {
            window.RufflePlayer.config.base = "/z/games/heist/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("sarassuperspa") > -1) {
            window.RufflePlayer.config.base = "/z/games/sarassuperspa/core/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("dentaladventure") > -1) {
            window.RufflePlayer.config.base = "/z/games/dentaladventure/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("angelico") > -1) {
            window.RufflePlayer.config.base = "/z/games/angelico/"
            console.log("base:" + window.RufflePlayer.config.base);
        }
        
        if (dirName.indexOf("hoshisaga") > -1) {
            window.RufflePlayer.config.base = "/z/games/hoshisaga/"
            console.log("base:" + window.RufflePlayer.config.base);
        }

        window.addEventListener("DOMContentLoaded", () => {
            let ruffle = window.RufflePlayer.newest();
            let player = ruffle.createPlayer();
            let container = document.getElementById("container");
            container.appendChild(player);
		if (gameName && gameName.indexOf("frivMenuPhoenix") > -1) {
                
                window.RufflePlayer.config = {
                    autoplay: "on",
                };
                player.load("/old/frivMenuPhoenix.swf");
                
            } else {
                player.load("/z/games/" + dirName + "/" + gameName + ".swf");
            }

        });

        setTimeout(function() {
            scaleGame();
        }, 500);

        window.addEventListener("resize", scaleGame);

        function scaleGame() {

            document.getElementsByTagName("ruffle-player")[0].style.height = "100vh";
            document.getElementsByTagName("ruffle-player")[0].style.width = (gameRatio * 100) + "vh";
            document.getElementsByTagName("ruffle-player")[0].style.boxShadow = "0 0 5vmin 1vmin black";
            document.getElementsByTagName("ruffle-player")[0].style.marginTop = 0;

            if (document.getElementsByTagName("ruffle-player")[0].offsetWidth > window.innerWidth) {
                console.log(document.getElementsByTagName("ruffle-player")[0].offsetWidth);
                document.getElementsByTagName("ruffle-player")[0].style.width = "100vw";
                document.getElementsByTagName("ruffle-player")[0].style.height = (100 / gameRatio) + "vw";
                document.getElementsByTagName("ruffle-player")[0].style.marginTop = ((window.innerHeight - document.getElementsByTagName("ruffle-player")[0].offsetHeight) / 2) + "px";
            }

        }

    </script>
    <script src="./pp/ruffle.js"></script> <!-- UPDATE -->

</body>

</html>
